# 第1章 人工智能体验
    本章介绍

## 第1节 人工智能的数学基础

## 第2节 趣味概率论与信息论

## 第3节 Python计算机视觉编程

### 3.1 基于opencv的人脸识别操作

    在树莓派上利用opencv进行相关操作，实现对给定图片中相关人脸的识别功能

#### 硬件准备

- 树莓派、电源连接线、鼠标、键盘、以及显示屏

#### 环境准备

1.首先我们需要安装python3
在这一步里我们需要登陆python官网

> <https://www.python.org/downloads/source/>

并下载合适的python版本
2.将树莓派开机并在命令行中输入如下操作

>sudo apt-get install libcv-dev
sudo apt-get install python-opencv

这一步我们是完成opencv在树莓派上的安装，在安装后我们可以通过以下操作来导入opencv
>1、打开命令行并输入

     python3  
![12](图片/1.png)

>2、接着输入

```bash
import cv2
```

![12](图片/2.png)
>3、之后我们可以通过以下代码来检测我们所使用的opencv版本
![12](图片/3.png)

3.接着我们需要安装两个库 (numpy 和 matlitlib) 一个用于计算一个用于图像绘制
使用以下代码在命令行中进行安装

```bash
pip install numpy
sudo apt-get install python3-matplotlib
```

这样我们就完成了实验所需所有的环境配置

#### 程序及操作

1.首先需要在下面的网址里下载一个 cascade file
<https://raw.githubusercontent.com/shantnu/Webcam-Face-Detect/master/haarcascade_frontalface_default.xml>

并将其另存为

*_haarcascade_frontalface_default.xml_*

2.创建一个 .py 的文件 ( 可用我们之前安装的 Python3 打开 ) 并在文件中输入以下代码

```python
# Import OpenCV library
import cv2

# Load a cascade file for detecting faces
faceCascade = cv2.CascadeClassifier("haarcascade_frontalface_default.xml");

# Load image
image = cv2.imread('picturex.jpeg')

# Convert into grayscale
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# Look for faces in the image using the loaded cascade file
faces = faceCascade.detectMultiScale(gray, 1.2, 5)
for (x,y,w,h) in faces:
	# Create rectangle around faces
    cv2.rectangle(image,(x,y),(x+w,y+h),(255,255,0),2)

# Create the resizeable window
cv2.namedWindow('picturex', cv2.WINDOW_NORMAL)

# Display the image
cv2.imshow('picturex', image)

# Wait until we get a key
k=cv2.waitKey(0)

# If pressed key is 's'
if k == ord('s'):
    # Save the image
    cv2.imwrite('convertedimage.jpg', image)
    # Destroy all windows
    cv2.destroyAllWindows()
# If pressed key is ESC
elif k == 27:
    # Destroy all windows
cv2.destroyAllWindows()
```

**_第8/15/23行的picturex是我们需要更改的图片名字_**

3.将 cascade file、.py文件、以及我们所需要识别的图片发在同一路径下就像下图一样 ( 这保证了我们一会程序运行的确定性 )
<center>

![12](图片/4.png)
</center>

4.运行程序
需要我们在该目录下打开命令行（可使用快捷键鼠标点击路径按F4实现）
在命令行中输入

```python
#filename.py是你保存的代码文件的名称
python3 filename.py
```

之后我们就可以看到我们所选择的的图片加载出来，并且其中的人物的脸部会用方框圈起来

## 第4节 前馈神经网络（BPN）应用

### 4.1 MNIST手写数字识别

## 第5节 卷积神经网络（CNN）应用

### 5.1 Tensorflow训练自定义图片分类器

    简单的项目描述

#### 硬件准备

#### 程序及操作

### 5.2 图像风格迁移

<center>

![Neural Style 图像风格迁移](http://psqevyxc3.bkt.clouddn.com/neuralstyle.jpg)
</center>

在神经网络之前，图像风格迁移的程序有一个共同的思路：分析某一种风格的图像，给那一种风格建立一个数学或者统计模型，再改变要做迁移的图像让它能更好的符合建立的模型。这样做出来效果还是不错的，但一个很大的缺点：**一个程序基本只能做某一种风格或者某一个场景**。因此基于传统风格迁移研究的实际应用非常有限。
而 Neural Style 程序通过输入一张代表内容的图片和一张代表风格的图片，使用深度学习网络输出一张融合了这个风格和内容的新作品。

#### 环境准备

##### VGG 网络

[训练好的 VGG 19 网络](http://www.vlfeat.org/matconvnet/models/imagenet-vgg-verydeep-19.mat)，下载到项目文件夹“Neural Style 图像风格迁移”的中，或在运行时使用参数 `--network` 指定其位置。

##### 软件准备

除了在本课程最开始已经在 Anaconda 的 learn-ai 环境中安装好的 `TensorFlow` 外，还需安装 `Pillow` 软件包。

1.macOS 用户打开终端，Windows用户打开 Anaconda Prompt；
2.输入下面的命令来进入 learn-ai 环境；

```bash
conda activate learn-ai
```

3.安装 `Pillow` 软件包；

```bash
conda install pillow
```

4.切换工作路径到项目文件夹；

```bash
cd 项目文件夹的路径
```

#### **程序及操作**

```bash
python neural_style.py --content <输入图片> --styles <风格图片> --output <输出文件名> -- --iterations <迭代次数>
```

我们使用 examples 文件夹中的 1-content.jpg 和 2-style1.jpg 来举例，把上面命令中：
<输入图片> 替换为 `examples/1-content.jpg`
<风格图片> 替换为 `examples/2-style1.jpg`
<输出文件名> 替换为 `examples/output.jpg`，当然也可以不叫output，使用你自己喜欢的名字；
<迭代次数> 替换为 `100`
替换后的命令为：

```bash
python neural_style.py --content examples/1-content.jpg --styles examples/2-style1.jpg --output examples/output.jpg -- --iterations 100
```

**注意：***<输入图片>* 不建议使用过大的图片，这会明显的增加机器的负担，特别是对于性能差或者没有独立显卡的机器，可能需要数个小时来生成新的图片。*<迭代次数>* 在课程中使用的是 100 次迭代，可以初步看出机器风格迁移的效果。一般来说 1000 次迭代可以获得不错的图像质量，但会花费更多的时间。

<center>

![完成]( http://psqevyxc3.bkt.clouddn.com/finishProcess.jpg)
</center>

当窗口中的迭代次数变为 “100/100” 时就完成了整个图片的处理过程，打开 examples 文件夹中的图片就可以开到结果。

## 第6节 深度神经网络（RNN）应用

### 6.1 使用循环神经网络（RNN）来生成古诗词

    简单的项目描述

#### 硬件准备

硬件

#### 程序及操作

@import "./chapter2/part1/古诗词/poet_rnn_output.py" {cmd='/anaconda3/envs/learn-ai/bin/python'}

## 第7节 人工智能与游戏

### 7.1 使用强化学习算法（DQN）训练游戏AI

    简单的项目描述

#### 硬件准备

#### 程序及操作

### 7.2 使用进化算法来训练马里奥

    简单的项目描述

#### 硬件准备

#### 程序及操作
