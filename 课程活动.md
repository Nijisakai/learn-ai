# 人工智能课程文档-课程活动部分

 <font size=5>目录</font>

<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=2 orderedList=false }-->
<!-- code_chunk_output -->

* [环境准备](#环境准备)
* [**Chapter 1 物联网与机器人**](#chapter-1-物联网与机器人)
* [Part 1 ESP8266简单应用](#part-1-esp8266简单应用)
* [Part 2 HomeAssistant简单应用](#part-2-homeassistant简单应用)
* [Part 3 高级项目-物联网机器人小绿](#part-3-高级项目-物联网机器人小绿)
* [**Chapter 2 人工智能与机器人**](#chapter-2-人工智能与机器人)
* [Part 1 人工智能算法相关案例体验](#part-1-人工智能算法相关案例体验)
* [Part 2 自动追踪小车](#part-2-自动追踪小车)
* [Part 3 无人驾驶小车](#part-3-无人驾驶小车)

<!-- /code_chunk_output -->

## 环境准备

### **Anaconda**

Anaconda是一个Python环境管理软件。在Windows，Mac、Linux上均可以方便安装。  
下载链接：<https://www.anaconda.com/distribution>
![Xnip2019-04-30_10-37-45](http://md.hass.live/Xnip2019-04-30_10-37-45.png)
选择适合自己的操作系统，并选择Python 3.7版本。

#### 基本命令

> **创建环境**

```bash
# conda create -n 环境名字
例如：  
# conda create -n py27 python=2.7
表示创建一个名字为py27，运行python2.7的虚拟环境。  
后面的python=2.7是可选输入。  
不输入时默认环境是python3。
```

> **进入环境**

```bash
# conda activate 环境名字
例如：  
# conda activate py27
```

> **安装指定包**  

```bash
# conda install 包名  
例如：安装OpenCV
# conda install opencv
```

> **其他命令**  

```bash
退出环境
# conda deactivate 环境名字  
列出环境
# conda-env list
删除环境
# conda-env remove -n 环境名字
```

#### setup

1.下载安装Anaconda  
2.在开始菜单找到Anaconda Prompt并进入  
3.创建并进入环境。python版本为默认的3.x  
4.在新环境中安装TensorFlow和OpenCV（若电脑有独立显卡应安装GPU版本的TensorFlow）

```bash
# conda create -n myenv
# conda activate myenv
# conda install tensorflow
# conda install tensorflow-gpu  
# conda install opencv
# conda install git
```

### **VSCode**

VSCode是微软出品的免费代码编辑软件。在Windows，Mac、Linux上均可以方便安装。  
下载链接：<https://code.visualstudio.com>

#### setup

1.下载安装VSCode  
2.安装插件“Settings Sync”  
![2019-04-29 21.49.44](http://md.hass.live/2019-04-29%2021.49.44.gif)
3.输入`Shift` + `Alt` + `D`,输入GitHub Token和Gist Token([点击获取](http://lab.playwithai.com:8999/))，即可从服务端同步设置。免去自己配置的麻烦。

### **Arduino IDE**

Arduino IDE是针对Arduino控制板的编程和下载平台。在Windows，Mac、Linux上均可以方便安装。  
Arduino项目文件的后缀是*.ino。项目文件应在与项目名相同的文件夹中。
下载链接：<https://www.arduino.cc/en/Main/Software>

#### setup

1.下载安装Arduino IDE  
2.在`文件`--`首选项`--`附加开发板管理器网址`一栏中输入<http://arduino.esp8266.com/stable/package_esp8266com_index.json>，重启IDE
![arduino-config-1](http://md.hass.live/arduino-config-1.png)
3.在`工具`--`开发板`--`开发板管理器`中搜索esp8266,点击对应项进行安装  
![2019-04-29 22.10.50](http://md.hass.live/2019-04-29%2022.10.50.gif)
4.打开链接<https://github.com/esp8266/arduino-esp8266fs-plugin/releases/tag/0.4.0>,选择.zip文件下载，将解压后的文件夹复制到`Arduino安装目录/tools`文件夹。然后重启IDE。
默认的路径应该是这样：`C:\Program Files (x86)\Arduino\tools\ESP8266FS\tool\esp8266fs.jar`
![arduino-config-2](http://md.hass.live/arduino-config-2.png)
<center><img src=http://md.hass.live/arduino-config-3.png></center>

### **CP2102驱动**

这个驱动用于使用USB串口连接ESP8266
下载链接: <https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers>

### **其他**

Xshell（Windows）、FinalShell（macOS）、Google Chrome、VNC Viewer等

### **下载课程所需文件**

打开Anaconda Prompt
macOS用户执行`git clone https://github.com/nijisakai/learn-ai.git ~/Desktop/ai/`  
文件被下载到桌面下面的ai文件夹

Windows用户执行`git clone https://github.com/nijisakai/learn-ai.git C:/ai`  
文件被下载到C盘根目录下面的ai文件夹

---

## **Chapter 1 物联网与机器人**

    本章内容是关于使用可编程的开源硬件，将功能点进行分解，并最终实现综合项目。
    主要包括
    1.使用物联网开发板来读取和控制传感器、灯和舵机等设备
    2.安装和配置物联网平台，实现语音控制和人脸解锁
    3.自主设计制作一个融合了多种功能的基于3D打印物联网机器人或小车。

## Part 1 ESP8266简单应用

    ESP8266是一个价格低廉的开发板，包含WiFi模块和GPIO，可以连接传感器、舵机、马达等各种设备。使用Arduino IDE进行开发编程。可通过网络、串口和蓝牙等多种方式进行通信。

### Part 1.1 使用ESP8266在网页上读取传感器数据

    这部分让你熟悉操作ESP8266的步骤。是第一章的基础。
    包括功能提出和实现，硬件连接，上传的参数调节和html文件在本地服务器中的打开，传感器数据的实时呈现等。
    这部分主要包括两种传感器的读取，为温湿度传感器和超声波传感器。

#### **硬件部分**

##### 硬件清单

* ESP8266主板
* 温湿度传感器（型号为DHT11或DHT22）
* 超声波传感器（型号为HC-SR04）
* 杜邦线、数据线

##### 硬件连接

<center><img src=https://md.hass.live/Xnip2019-05-05_11-52-46.png></center>

<center><img src=https://md.hass.live/Xnip2019-05-05_12-02-00.png></center>

#### **算法及程序**

##### 操作步骤

1. 打开Anaconda Prompt
2. macOS用户输入`git clone safafafa ~/Desktop/learn ai/chapter1/part1/part1.1/esp8266_DHT11/`
Windows用户输入

##### 代码详解

* 温湿度传感器

```arduino {.line-numbers}
/*如果代码用文字来描述的话，看起来是这样的：
  
  首先，先增加一些外部的工具包，这些工具包里有很多好用的方法，这些方法通常都是牛人帮你写好的，拿来用就行了。
  
  然后，为所有需要操作的东西都起一些特定的名字，名字之前还要指定类别。
  做完这些定义后，



  Arduino程序包含了两个主要的方法，分别是
  void setup()和void loop()
  方法后面写一对{},在这里面写方法的具体内容。看起来像是这样：
  void setup(){
    自己规定的语句
    自己规定的语句
    自己规定的语句
  }
  void loop(){
    自己规定的语句
    自己规定的语句
    自己规定的语句
  }
*/


//使用 #include来引用一些附加的功能。
#include <ESP8266WiFi.h>
#include <ESP8266WebServer.h>
#include "DHT.h"


// 选择使用哪种DHT传感器。
#define DHTTYPE DHT11   // DHT 11
//#define DHTTYPE DHT21   // DHT 21 (AM2301)
//#define DHTTYPE DHT22   // DHT 22  (AM2302), AM2321

/*Put your SSID & Password*/
const char* ssid = "AI";  // Enter SSID here
const char* password = "raspberry";  //Enter Password here

ESP8266WebServer server(80);

// DHT Sensor
uint8_t DHTPin = D8;

// Initialize DHT sensor.
DHT dht(DHTPin, DHTTYPE);
float Temperature;
float Humidity;

void setup() {
  Serial.begin(115200);
  delay(100);
  
  pinMode(DHTPin, INPUT);

  dht.begin();

  Serial.println("Connecting to ");
  Serial.println(ssid);

  //connect to your local wi-fi network
  WiFi.begin(ssid, password);

  //check wi-fi is connected to wi-fi network
  while (WiFi.status() != WL_CONNECTED) {
  delay(1000);
  Serial.print(".");
  }
  Serial.println("");
  Serial.println("WiFi connected..!");
  Serial.print("Got IP: ");  Serial.println(WiFi.localIP());

  server.on("/", handle_OnConnect);
  server.onNotFound(handle_NotFound);

  server.begin();
  Serial.println("HTTP server started");

}
void loop() {
  
  server.handleClient();
  
}

void handle_OnConnect() {

 Temperature = dht.readTemperature(); // Gets the values of the temperature
  Humidity = dht.readHumidity(); // Gets the values of the humidity
  server.send(200, "text/html", SendHTML(Temperature,Humidity));
}

void handle_NotFound(){
  server.send(404, "text/plain", "Not found");
}

String SendHTML(float Temperaturestat,float Humiditystat){
  String ptr = "<!DOCTYPE html> <html>\n";
  ptr +="<head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\">\n";
  ptr +="<title>ESP8266 DHT11</title>\n";
//  ptr +="<style>html { font-family: Helvetica; display: inline-block; margin: 0px auto; text-align: center;}\n";
//  ptr +="body{margin-top: 50px;} h1 {color: #444444;margin: 50px auto 30px;}\n";
//  ptr +="p {font-size: 24px;color: #444444;margin-bottom: 10px;}\n";
//  ptr +="</style>\n";
  ptr +="<script>\n";
  ptr +="setInterval(loadDoc,200);\n";
  ptr +="function loadDoc() {\n";
  ptr +="var xhttp = new XMLHttpRequest();\n";
  ptr +="xhttp.onreadystatechange = function() {\n";
  ptr +="if (this.readyState == 4 && this.status == 200) {\n";
  ptr +="document.getElementById(\"webpage\").innerHTML =this.responseText}\n";
  ptr +="};\n";
  ptr +="xhttp.open(\"GET\", \"/\", true);\n";
  ptr +="xhttp.send();\n";
  ptr +="}\n";
  ptr +="</script>\n";
  ptr +="</head>\n";
  ptr +="<body>\n";
  ptr +="<div id=\"webpage\">\n";
//  ptr +="<h1>ESP8266 NodeMCU Weather Report</h1>\n";
  
  ptr +="<p>温度: ";
  ptr +=(int)Temperaturestat;
  ptr +="°C</p>";
  ptr +="<p>湿度: ";
  ptr +=(int)Humiditystat;
  ptr +="%</p>";
  
  ptr +="</div>\n";
  ptr +="</body>\n";
  ptr +="</html>\n";
  return ptr;
}
```

* 超声波传感器

```arduino {.line-numbers}
/*
 * Description: Distance measurement using ultrasonic HC-SR04 and ESP8266 connected to AskSensors
 *  Author: https://asksensors.com, 2018
 *  github: https://github.com/asksensors
 */

#include <Arduino.h>
#include <ESP8266WiFi.h>
#include <ESP8266WiFiMulti.h>
#include <ESP8266HTTPClient.h>
#include <ESP8266WebServer.h>
// utlrasonic pinout
#define ULTRASONIC_TRIG_PIN     5   // pin TRIG to D1
#define ULTRASONIC_ECHO_PIN     4   // pin ECHO to D2

// user config: TODO
const char* wifi_ssid = "AI";             // SSID
const char* wifi_password = "raspberry";         // WIFI
//const char* apiKeyIn = "3wal5hvL3vDtKOhBQ2TpBH5mzDgw94VO";      // dd KEY IN
ESP8266WebServer server(80);
// ASKSENSORS config.
//String host = "http://asksensors.com";         // ASKSENSORS host name

ESP8266WiFiMulti WiFiMulti;

void setup() {

  Serial.begin(115200);
  Serial.println("*****************************************************");
  Serial.println("********** Program Start : Connect Ultrasonic HC-SR04 + ESP8266 to AskSensors over HTTP");
  Serial.println("Wait for WiFi... ");
  Serial.print("********** connecting to WIFI : ");
  Serial.println(wifi_ssid);
  WiFi.begin(wifi_ssid, wifi_password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("");
  Serial.println("-> WiFi connected");
  Serial.println("-> IP address: ");
  Serial.println(WiFi.localIP());
  // ultraonic setup
  pinMode(ULTRASONIC_TRIG_PIN, OUTPUT);
  pinMode(ULTRASONIC_ECHO_PIN, INPUT);
  server.on("/", handle_OnConnect);
  server.onNotFound(handle_NotFound);
  server.begin();
  
}


void loop() {
  
  server.handleClient();
  
}

void handle_OnConnect() {
  long duration, distance;
  digitalWrite(ULTRASONIC_TRIG_PIN, LOW);
  delayMicroseconds(2);
  digitalWrite(ULTRASONIC_TRIG_PIN, HIGH);
  delayMicroseconds(10);
  digitalWrite(ULTRASONIC_TRIG_PIN, LOW);
  duration = pulseIn(ULTRASONIC_ECHO_PIN, HIGH);
  distance = (duration/2) / 29.1;
  server.send(200, "text/html", SendHTML(distance));
}

void handle_NotFound(){
  server.send(404, "text/plain", "Not found");
}

String SendHTML(long distance){
  String ptr = "<!DOCTYPE html> <html>\n";
  ptr +="<head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\">\n";
  ptr +="<title>ESP8266 DHT11</title>\n";
//  ptr +="<style>html { font-family: Helvetica; display: inline-block; margin: 0px auto; text-align: center;}\n";
//  ptr +="body{margin-top: 50px;} h1 {color: #444444;margin: 50px auto 30px;}\n";
//  ptr +="p {font-size: 24px;color: #444444;margin-bottom: 10px;}\n";
//  ptr +="</style>\n";
  ptr +="<script>\n";
  ptr +="setInterval(loadDoc,200);\n";
  ptr +="function loadDoc() {\n";
  ptr +="var xhttp = new XMLHttpRequest();\n";
  ptr +="xhttp.onreadystatechange = function() {\n";
  ptr +="if (this.readyState == 4 && this.status == 200) {\n";
  ptr +="document.getElementById(\"webpage\").innerHTML =this.responseText}\n";
  ptr +="};\n";
  ptr +="xhttp.open(\"GET\", \"/\", true);\n";
  ptr +="xhttp.send();\n";
  ptr +="}\n";
  ptr +="</script>\n";
  ptr +="</head>\n";
  ptr +="<body>\n";
  ptr +="<div id=\"webpage\">\n";
//  ptr +="<h1>ESP8266 Distance</h1>\n";
  
  ptr +="<p>距离: ";
  ptr +=(float)distance;
  ptr +="厘米</p>";
//  ptr +="<p>湿度: ";
//  ptr +=(int)Humiditystat;
//  ptr +="%</p>";
  
  ptr +="</div>\n";
  ptr +="</body>\n";
  ptr +="</html>\n";
  return ptr;
}
```

### Part 1.2 WiFi遥控小车

    使用ESP8266，通过网页端发送命令，遥控一辆小车。

#### **硬件部分**

##### 硬件清单

* ESP8266主板
* 电机扩展板 ESP12E Motor Shield
* 小车套件
* 杜邦线，数据线

##### 硬件连接

<center><img src=https://md.hass.live/Xnip2019-05-05_11-51-26.png></center>

#### **算法及程序**

* WiFi小车程序

```arduino {.line-numbers}
#include <ESP8266WiFi.h>
#include <WiFiClient.h>
#include <ESP8266WebServer.h>
#include <ESP8266mDNS.h>
#include <FS.h>
#define Motor_AE D1      //Motor A/B,E enable,D Direction
#define Motor_AD D3

#define Motor_BE D2
#define Motor_BD D4

#define R_AHEAD HIGH
#define L_AHEAD LOW

String command;

// D1 On / Off
// D2 On / Off
// D3 Direction

// AP password
const char WiFiAPPSK[] = "raspberry";

ESP8266WebServer server(80);

const int led = 13;

void carInit(){  
  pinMode(Motor_AE, OUTPUT);
  pinMode(Motor_AD, OUTPUT);
  pinMode(Motor_BE, OUTPUT);
  pinMode(Motor_BD, OUTPUT);

  Serial.begin(115200);
  Serial.println("Car begin");
  }
void goAhead(){
      digitalWrite(Motor_AE, HIGH);
      digitalWrite(Motor_AD, L_AHEAD);
      digitalWrite(Motor_BE, HIGH);
      digitalWrite(Motor_BD, R_AHEAD);
  }

void goBack(){
      digitalWrite(Motor_AE, HIGH);
      digitalWrite(Motor_AD, !L_AHEAD);
      digitalWrite(Motor_BE, HIGH);
      digitalWrite(Motor_BD, !R_AHEAD);
  }

void goRight(){
      digitalWrite(Motor_BE, LOW);
      digitalWrite(Motor_AE, HIGH);
      digitalWrite(Motor_AD, L_AHEAD);
  }

void goLeft(){
      digitalWrite(Motor_BE, HIGH);
      digitalWrite(Motor_AE, LOW);
      digitalWrite(Motor_BD, R_AHEAD);
  }

void stopRobot(){  
      digitalWrite(Motor_AE, LOW);
      digitalWrite(Motor_BE, LOW);
  }

void handleNotFound(){
  digitalWrite(led, 1);
  String message = "File Not Found\n\n";
  message += "URI: ";
  message += server.uri();
  message += "\nMethod: ";
  message += (server.method() == HTTP_GET)?"GET":"POST";
  message += "\nArguments: ";
  message += server.args();
  message += "\n";
  for (uint8_t i=0; i<server.args(); i++){
    message += " " + server.argName(i) + ": " + server.arg(i) + "\n";
  }
  server.send(404, "text/plain", message);
  digitalWrite(led, 0);
}

void setup(void){
  carInit();
  SPIFFS.begin();
//  Serial.begin(115200);

    // AP SSID Name
  uint8_t mac[WL_MAC_ADDR_LENGTH];
  WiFi.softAPmacAddress(mac);
  String macID = String(mac[WL_MAC_ADDR_LENGTH - 2], HEX) + String(mac[WL_MAC_ADDR_LENGTH - 1], HEX);
  macID.toUpperCase();

  String AP_NameString = "Wifi Car - " + macID;

  char AP_NameChar[AP_NameString.length() + 1];
  memset(AP_NameChar, 0, AP_NameString.length() + 1);

  for (int i = 0; i < AP_NameString.length(); i++)
    AP_NameChar[i] = AP_NameString.charAt(i);
 /*
  WiFi.softAP(AP_NameChar, WiFiAPPSK);
  IPAddress myIP = WiFi.softAPIP();
    */

//  Serial.println(res);
const char* ssid = "AI";
const char* password = "raspberry";
  WiFi.mode(WIFI_STA);
  WiFi.begin(ssid, password);
  Serial.println("");
  // Wait for connection
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("");
  Serial.print("Connected to ");
  Serial.println(ssid);
  Serial.print("IP address: ");
  Serial.println(WiFi.localIP());
  if (MDNS.begin("esp8266")) {
    Serial.println("MDNS responder started");
  }


  //server.on("/", handleRoot);
  server.serveStatic("/", SPIFFS, "/index.html");

  server.on("/get", [](){
    String uri = server.uri();
    Serial.println(uri);
    command = server.arg("command");
    if(command == "forward")
      goAhead();
    else if(command == "backward")
      goBack( );
    else if(command == "left")
      goLeft();
    else if(command == "right")
       goRight();
    else if(command == "stop")
       stopRobot();
    Serial.println(command);
//    setCorlor(red.toInt(),green.toInt(),blue.toInt());
    server.send(200, "text/plain", String("set to ")+command);
  });

  server.onNotFound(handleNotFound);

  server.begin();
  Serial.println("HTTP server started");
}

void loop(void){
  server.handleClient();
}
```

* 使用ESP8266 Sketchup上传的html文件

```html {.line-numbers}
<!DOCTYPE html>
<html>
    <head>
        <style type=text/css>
            .row{
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            .col{
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: center;
            }
            .control{
                width: 40%;
                height: 40%;
            }
            button{
                padding: 10px;
                margin: 20px 30px;
            }
        </style>
        <script>
            var keys = {};
            var command = '';
            var stored_command = '';
            function send_command(comm){
                if(stored_command == comm)
                    return;
                stored_command = comm;
                command = comm;
                printKeys();
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open('GET', '/get?command='+comm);
                xmlhttp.send();
                xmlhttp.onreadystatechange = function() {
                      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                            requstData = xmlhttp.responseText;
                            console.log(requstData);
                      };
                };
            }
            document.onkeydown = function (e) {
                var element = e.which;
                if (element == '37')
                    command = 'left';
                else if (element == '38')
                    command = 'forward';
                else if (element == '39')
                    command = 'right';
                else if (element == '40')
                    command = 'backward';
                else
                    command = 'stop';
                if(stored_command == command)
                    return;
                console.log(command,stored_command);
                send_command(command)
            };
            document.onkeyup = function (e) {
                command = 'stop';
                send_command(command);
            }
            function printKeys() {
                var html = command;
                document.getElementById('out').innerHTML = html;
            }
        </script>
    </head>
    <body>
        <!-- Click in this frame, then try holding down some keys -->
        <div id='out'></div>
    <div class=control>
        <div class=col>
        <button type='button' value='' id='up' onclick=send_command('forward') >向上</button>
        <div class=row>
            <button type='button' value='' id='left' onclick=send_command('left') >向左</button>
            <button type='button' value='' id='stop'  onclick=send_command('stop') >停止</button>
            <button type='button' value='' id='right' onclick=send_command('right') >向右</button>
        </div>
        <button type='button' value='' id='down' onclick=send_command('backward') >向下</button>
        </div>
    </div>

    </body>
</html>
```

### Part 1.3 使用ESP8266通过WiFi控制机械臂舵机

    使用ESP8266，通过网页端发送命令，控制多个舵机。

#### **硬件部分**

##### 硬件清单

* ESP8266主板
* 舵机
* 杜邦线、数据线

##### 硬件连接

<center><img src=https://md.hass.live/Xnip2019-05-05_11-57-01.png></center>

#### **算法及程序**

```arduino {.line-numbers}
#include <ESP8266WiFi.h>
#include <FS.h>
#include <Servo.h>
#include "server.h"
//#include <Stepper.h>
//// pins used for the rgb led
//char serial_line[100] ="";
//int serial_line_length=0;
//char val='/';
//#define STEPS 100
//Stepper stepper(STEPS, 8, 9, 10, 11);
//int pos;
//int pos1;
//int i ;
// Wifi: SSID and password
const char* WIFI_SSID = "AI";
const char* WIFI_PASSWORD = "raspberry";

Servo servos[12];
uint8_t servo_pins[12] = {D0,D1,D2,D3,D4,D5,D6,D7,D8,D9,D10,D11};
uint8_t count = 12;
void setAngle(uint8_t di,uint8_t vi){
  if(di< 12 && vi < 180)
    servos[di].write(vi);
}
void attachServos(){
  for (uint8_t i = 0; i < count; ++i){
    servos[i].attach(servo_pins[i]);
  }
}

void detachServos(){
  for (uint8_t i = 0; i < count; ++i){
    servos[i].detach();
  }  
}

void handleNotFound(){
  String message = "File Not Found\n\n";
  message += "URI: ";
  message += server.uri();
  message += "\nMethod: ";
  message += (server.method() == HTTP_GET)?"GET":"POST";
  message += "\nArguments: ";
  message += server.args();
  message += "\n";
  for (uint8_t i=0; i<server.args(); i++){
    message += " " + server.argName(i) + ": " + server.arg(i) + "\n";
  }
  server.send(404, "text/plain", message);
}

void setup() {
  // init the serial
  Serial.begin(115200);
  Serial.println();
  Serial.println("Server initial");
  //init the server
  SPIFFS.begin();
      Serial.println("SPIFFS begin");
  attachServos();
    Serial.println("Servos attached");
  server.serveStatic("/", SPIFFS, "/index.html");
  server.on("/set-servo", [](){
    String uri = server.uri();
    Serial.println(uri);
    String di = server.arg("di");
    String vi = server.arg("vi");
    Serial.println("di="+di+" vi="+vi);
    setAngle(di.toInt(),vi.toInt());
    server.send(200, "text/plain", String("set to ")+"di="+di+" vi="+vi);
  });
  server.onNotFound(handleNotFound);
  server.begin();
  Serial.println("HTTP server started");
  

  // init the WiFi connection
  Serial.println();
  Serial.println();
  Serial.print("INFO: Connecting to ");
  WiFi.mode(WIFI_STA);
  Serial.println(WIFI_SSID);
  WiFi.begin(WIFI_SSID, WIFI_PASSWORD);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("");
  Serial.println("INFO: WiFi connected");
  Serial.print("INFO: IP address: ");
  Serial.println(WiFi.localIP());

}

void loop() {
  server.handleClient();
}
```

* 对应的html文件

```html {.line-numbers}
<!DOCTYPE html>
<html>
    <head>
        <title>Servo Test</title>
        <meta name=viewport content="width=device-width, initial-scale=1">
        <meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <style type="text/css">
            input {
                width: 100%;
                height: 72px;
            }

            label {
                font-size: 24px;
            }
        </style>
    </head>
    <body>
        <H1>Welcome To Servo Test</H1>
        <form id=myForm action=/set-servo>


<!--             <div>
                <label for=d0>D0 </label>
                <div></div>
                <input type=range name=d0 id=d0 value=0 onchange=Submit()>
            </div> -->

        </form>
        <script type='text/javascript'>

            function debug(){
                var angles = []
                for (var i = 0; i < 12; i++) {
                    angles[i] = document.getElementById('d'+i).value;
                }
                console.log('uint8_t angles = {',angles.join(' , '),'}')
                trims = angles.map(e => e - 90);
                console.log('uint8_t trims = {',trims.join(' , '),'}')
            }

            function init(){
                var form = document.getElementById('myForm')
                var html = ''
                for (var i = 0; i < 12; i++) {
                    html+='<div><label for="d'+i+'">D'+i+'</label><div></div></div><input type="range" min="15" max="165" name="d'+i+'" id="d'+i+'" value="90" onchange=Submit("'+i+'")></div>';
                }
                form.innerHTML = html;
            }

            function setAngle(di,vi) {
                var xmlHttp = '';
                var requstData = '';
                var html = '';
                if (window.XMLHttpRequest) {
                    xmlHttp = new XMLHttpRequest();
                } else {
                    xmlHttp = new ActiveXObject('Microsoft.XMLHTTP');
                xmlHttp.open('GET', '/set-servo?di='+di+'&vi='+vi, true);
                xmlHttp.send();
                xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                    requstData = xmlHttp.responseText;
                    console.log(requstData);
                }
                };
            }

            function Submit(i){
                debug()
                var vi = document.getElementById('d'+i).value;
                console.log(i,vi);
                setAngle(i,vi);
            }



                  init();
        </script>
    </body>
</html>
```

---

## Part 2 HomeAssistant简单应用

    什么是HomeAssistant

### Part 2.1 物联网平台HomeAssistant安装

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 2.2 HomeAssistant控制ESP8266彩色灯

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 2.3 HomeAssistant进行人脸识别和语音播报

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

---

## Part 3 高级项目-物联网机器人小绿

    简介

### Part 3.1 组装一个小绿

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 3.2 让小绿开口说话

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 3.3 让小绿听你指挥

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 3.4 使用Google Blockly来控制小绿

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

---

## **Chapter 2 人工智能与机器人**

    这一部分包括……

## Part 1 人工智能算法相关案例体验

    介绍

### Part 1.1 Tensorflow训练自定义图片分类器

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 1.2 使用RNN来生成古诗词

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 1.3 训练一个简单的游戏AI（Deep Q Network）

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 1.4 使用进化算法来训练超级马里奥

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

---

## Part 2 自动追踪小车

    项目介绍

### Part 2.1 环境准备与硬件搭建

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 2.2 使用串口与Arduino通信，实现简单的机械臂抓取

    使用OpenCV来识别圆形物体，若识别到则发送串口指令给Arduino。Arduino控制机械臂进行抓取。

#### **硬件部分**

#### **算法及程序**

### Part 2.3 OpenCV分类器训练，让小车追踪特定物体

    通过拍照、爬虫等方式获取待训练图片，使用python进行简单的文件处理，用OpenCV训练后，可实现对特定物体的识别和追踪。

#### **硬件部分**

#### **算法及程序**

---

## Part 3 无人驾驶小车

    项目介绍

### Part 3.1 环境准备与硬件搭建

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 3.2 无人驾驶训练

    简单的项目描述

#### **硬件部分**

#### **算法及程序**

### Part 3.3 无人驾驶测试

    简单的项目描述

#### **硬件部分**

#### **算法及程序**
