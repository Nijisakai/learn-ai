# 第3节 是汽车也是汽车人：小白机械臂

使用esp8266，通过网页端发送命令，控制多个舵机

## 学习流程

### 课程引入（15分钟）

活动名称 | 活动内容 | 时间分配
:-: | :-: | :-:
活动目标| 通过WiFi超控机械臂 | 5分钟
背景知识 | 舵机的工作原理及脉冲宽度调制 | 10分钟

### 基本任务（35分钟）

活动名称 | 活动内容 | 时间分配
:-: | :-: | :-:
硬件准备 | 将硬件按文档进行连接 | 5分钟
程序及操作 | 完成程序及操作文档部分 | 25分钟

### 活动小结（10分钟）

## 活动目标

- 了解舵机的原理和使用方法
- 了解脉冲宽度调制（PWM）
- 通过WiFi遥控机械臂

## 背景知识

### 舵机

伺服电机通常被称为舵机，它是一种带有输出轴的小装置。当我们向伺服器发送一个控制信号时，输出轴就可以转到特定的位置。只要控制信号持续不变，伺服机构就会保持轴的角度位置不改变。如果控制信号发生变化，输出轴的位置也会相应发生变化。日常生活中，舵机常被用于遥控飞机、遥控汽车、机器人等。

### 舵机的工作原理

![舵机结构](https://md.hass.live/niji/2019-05-27-%E8%88%B5%E6%9C%BA%E6%8B%86%E8%A7%A3.jpg)

舵机内部的控制电路、电位计（可变电阻器）和电机均被连接到电路板上。控制电路通过电位计可监控舵机的当前角度。  

其工作流程为：控制信号 → 控制电路板 → 电机转动 → 齿轮组减速 → 舵盘转动 → 位置反馈电位计 → 控制电路板反馈。

![舵机转动图](https://md.hass.live/niji/2019-05-27-SERVO.gif)

### 脉冲宽度调制（PWM）

脉冲宽度调制，英文名Pulse Width Modulation，缩写为PWM，它是通过对一系列脉冲的宽度进行调制，等效出所需要的波形，对模拟信号电平进行数字编码。

#### 占空比

占空比是指在一个周期内，信号处于高电平的时间占据整个信号周期的百分比。

![占空比](https://md.hass.live/niji/2019-05-27-Xnip2019-05-27_09-37-35.png)

上图信号一个周期的时间为4ms，其中高电平时间为1ms。占空比为：$$ \frac {高电平时间} {一个周期} = \frac {1ms} {4ms} = 25\% $$

## 硬件准备

### 硬件清单

- esp8266主板
- 电机扩展板 esp12E Motor Shield
- 舵机
- 杜邦线、数据线
- 机械臂和零件

### 硬件连接

<center><img src=https://md.hass.live/Xnip2019-05-05_11-57-01.png?imageView2/0/interlace/1/q/46|imageslim></center>
<center>此处表示舵机连接到了D0口，最多可以连9个舵机（D0-D9）<br>
<font color=orange>黄色</font>-信号D（DATA）<br>
<font color=red>红色</font>-正极V（VCC）<br>
<font color=brown>棕色</font>-负极G（GND）<br>
</center>

## 程序及操作

### 操作步骤

1. 打开`learn-ai`文件夹，打开路径`codes/chapter2/esp8266_projects/esp8266_servoarm_http`  
2. 将esp8266通过数据线连接到电脑
3. 使用Arduino IDE打开文件`esp8266_servoarm_http.ino`  
4. 记得把前面的[环境准备](#setup-2)部分再次确认，将环境正确配置，然后点击上传按钮进行上传
![上传](https://md.hass.live/niji/2019-05-08-Xnip2019-05-08_10-15-02.png?imageView2/0/interlace/1/q/46|imageslim)

5. 点击`工具`菜单，选择`esp8266 Sketch Data Upload`,会自动将项目目录下的data文件夹上传到esp8266开发板上  
6. 打开[路由器管理地址](http://192.168.0.1)，esp8266此时应该已经加入到了局域网中，查看esp8266获取到的路由器地址  
7. 将esp8266与电脑连接断开，连接到移动电源上
8. 在浏览器中打开esp8266获取到的局域网地址，通过拖动滑块来控制机械臂

### 活动小结

总结课程主要内容，强调重难点
